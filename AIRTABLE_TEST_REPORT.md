# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ Airtable API

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. **Health Endpoint** (`/api/health.php`)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"ok": true` –¥–ª—è Airtable
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ"
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π PAT —Ç–æ–∫–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞

2. **Server Keys** (`/api/test-proxy.php?provider=server_keys`)
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç `"airtable": true`
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

3. **Airtable Whoami** (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"ok": true` —Å —Ä–µ–∞–ª—å–Ω—ã–º user ID
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω—ã–π PAT —Ç–æ–∫–µ–Ω

4. **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**
   - –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ "–ü—Ä–æ–≤–µ—Ä–∫–∞..."
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "Erase" –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª—é—á–µ–π
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è PAT —Ç–æ–∫–µ–Ω–æ–≤

### ‚ùå –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–õ–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ"**
   - –ü—Ä–æ–±–ª–µ–º–∞: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ–∫–∞–∑—ã–≤–∞–ª "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ" –¥–∞–∂–µ –±–µ–∑ –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω—ã –∫—ç—à-–±–∞—Å—Ç–µ—Ä—ã –∏ `cache: 'no-store'` –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

2. **–û—Ç–ø—Ä–∞–≤–∫–∞ placeholder —Ç–æ–∫–µ–Ω–æ–≤**
   - –ü—Ä–æ–±–ª–µ–º–∞: Placeholder —Ç–æ–∫–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
   - –†–µ—à–µ–Ω–∏–µ: –ö–Ω–æ–ø–∫–∞ "Test" –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PAT, —Ç–æ–ª—å–∫–æ –º–∞–ø–ø–∏–Ω–≥

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤**
   - –ü—Ä–æ–±–ª–µ–º–∞: –õ—é–±—ã–µ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏–Ω–∏–º–∞–ª–∏—Å—å –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–µ
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ `pat.` + –º–∏–Ω–∏–º—É–º 20 —Å–∏–º–≤–æ–ª–æ–≤

4. **–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–∏—Ç—å –∫–ª—é—á–∏**
   - –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –±—ã–ª–æ —Å–ø–æ—Å–æ–±–∞ —É–¥–∞–ª–∏—Ç—å –∫–ª—é—á–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "Erase" –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. –§—É–Ω–∫—Ü–∏—è `clearLocalCaches()`
```javascript
function clearLocalCaches(){
  try{
    [
      'konstructour_regions_cache_v1',
      'konstructour_cities_cache_v2',
      'konstructour_pois_cache_v2',
      'konstructour_last_refresh',
      'konstructour_last_sync'
    ].forEach(k=> localStorage.removeItem(k));
  }catch(_){ /* ignore */ }
}
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è PAT —Ç–æ–∫–µ–Ω–æ–≤
```javascript
function isValidPatToken(token) {
  return token && /^pat\.[A-Za-z0-9_\-]{20,}$/.test(token);
}
```

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ö–Ω–æ–ø–∫–∞ "Test" –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PAT –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –¢–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ "Add" –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à-–±–∞—Å—Ç–µ—Ä—ã

### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
- –ö–Ω–æ–ø–∫–∞ "Erase" —É–¥–∞–ª—è–µ—Ç –∫–ª—é—á–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –û—á–∏—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫—ç—à–∏
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üéØ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

**‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π Airtable PAT
- Health endpoint –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- Placeholder —Ç–æ–∫–µ–Ω—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- –ö—ç—à–∏ –æ—á–∏—â–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏

**üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π Airtable PAT –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
2. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ –∫—ç—à–∏ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "Erase" –¥–ª—è —Å–±—Ä–æ—Å–∞ –∫–ª—é—á–µ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## üß™ –§–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. `test-airtable-status.html` - –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç API
2. `test-airtable-simple.html` - –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å –æ—Ç–ª–∞–¥–∫–æ–π
3. `test-admin-panel.html` - –¢–µ—Å—Ç –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
4. `test-airtable-api.sh` - –°–∫—Ä–∏–ø—Ç –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
5. `test-api-debug.js` - JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ:

–ü—Ä–æ–±–ª–µ–º–∞ –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ" –¥–ª—è Airtable **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç placeholder —Ç–æ–∫–µ–Ω—ã
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à-–±–∞—Å—Ç–µ—Ä—ã –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä.
