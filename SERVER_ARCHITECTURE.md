# üèóÔ∏è –°–µ—Ä–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Konstructour

## üìä –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–µ—Ä–≤–µ—Ä–Ω—É—é SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** –≤–º–µ—Å—Ç–æ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –∫—ç—à–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–≥–∏–æ–Ω—ã, –≥–æ—Ä–æ–¥–∞, POI).

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:
- **`regions`** - –†–µ–≥–∏–æ–Ω—ã –Ø–ø–æ–Ω–∏–∏
- **`cities`** - –ì–æ—Ä–æ–¥–∞ –∏ –ª–æ–∫–∞—Ü–∏–∏
- **`pois`** - –¢–æ—á–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞
- **`tickets`** - –ë–∏–ª–µ—Ç—ã –¥–ª—è POI
- **`sync_log`** - –õ–æ–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –°–≤—è–∑–∏:
- `cities.region_id` ‚Üí `regions.id`
- `pois.city_id` ‚Üí `cities.id`
- `pois.region_id` ‚Üí `regions.id`
- `tickets.poi_id` ‚Üí `pois.id`

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
0 */6 * * * /usr/bin/php /path/to/api/cron-sync.php
```

### –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
```bash
# –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
php api/init-sync.php

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API
curl -X POST http://yoursite.com/api/sync-airtable.php
```

## üìÅ –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã

### API —Ñ–∞–π–ª—ã:
- `api/database.php` - –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- `api/data-api.php` - REST API –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- `api/sync-airtable.php` - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä Airtable ‚Üí –ë–î
- `api/cron-sync.php` - Cron-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `api/init-sync.php` - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `api/config.php` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Airtable
- `api/konstructour.db` - SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Airtable —Ç–æ–∫–µ–Ω** –≤ `api/config.php`
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**
   ```bash
   php api/init-sync.php
   ```
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron –¥–ª—è –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
   ```bash
   crontab -e
   # –î–æ–±–∞–≤—å—Ç–µ: 0 */6 * * * /usr/bin/php /path/to/api/cron-sync.php
   ```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö:
- **50,000 POI** ‚âà 65 –ú–ë
- **500 –≥–æ—Ä–æ–¥–æ–≤** ‚âà 100 –ö–ë
- **50 —Ä–µ–≥–∏–æ–Ω–æ–≤** ‚âà 7.5 –ö–ë
- **–û–±—â–∏–π –æ–±—ä–µ–º** ‚âà 65 –ú–ë

### –°–∫–æ—Ä–æ—Å—Ç—å:
- **–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤** < 100ms
- **–ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ä–æ–¥–æ–≤** < 50ms
- **–ó–∞–≥—Ä—É–∑–∫–∞ POI** < 200ms
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** < 30 —Å–µ–∫—É–Ω–¥

## üîß API Endpoints

### –†–µ–≥–∏–æ–Ω—ã:
```
GET /api/data-api.php?action=regions
```

### –ì–æ—Ä–æ–¥–∞:
```
GET /api/data-api.php?action=cities&region_id=REGION_ID
```

### POI:
```
GET /api/data-api.php?action=pois&city_id=CITY_ID
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```
GET /api/data-api.php?action=stats
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
```
POST /api/sync-airtable.php
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- SQLite —Ñ–∞–π–ª –∑–∞—â–∏—â–µ–Ω –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ Airtable —Ç–æ–∫–µ–Ω–∞–º–∏

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `api/sync.log` - –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `api/konstructour.db` (—Ç–∞–±–ª–∏—Ü–∞ `sync_log`) - –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –∫—ç—à–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∞—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—É—é –ë–î. –°—Ç–∞—Ä—ã–π –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∫—ç—à –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ –≤ `api/sync.log`
2. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `api/konstructour.db`
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Airtable –≤ `api/config.php`
4. –°—Ç–∞—Ç—É—Å cron-–∑–∞–¥–∞—á
