# üîß Health Dashboard - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏ –Ω–µ—Ç–æ—á–Ω—ã–º –ø–æ–∫–∞–∑–∞–Ω–∏—è–º –¥–∞—à–±–æ—Ä–¥–∞.

## üö® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **CSS @apply –¥–∏—Ä–µ–∫—Ç–∏–≤—ã** ‚ùå ‚Üí ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** `@apply` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–±–æ—Ä–∫–∏ Tailwind CSS
```css
/* –ë—ã–ª–æ (–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ) */
.card{ @apply bg-white rounded-xl shadow p-5; }
.kbd{ @apply px-1.5 py-0.5 rounded bg-gray-100 border text-xs; }
```

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π CSS
```css
/* –°—Ç–∞–ª–æ (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ) */
.card{
  background:#fff;
  border-radius:0.75rem;
  box-shadow:0 1px 2px rgba(0,0,0,.05), 0 1px 1px rgba(0,0,0,.03);
  padding:1.25rem;
}
.kbd{
  padding:0.125rem 0.375rem;
  border-radius:0.25rem;
  background:#f3f4f6;
  border:1px solid #e5e7eb;
  font-size:0.75rem;
}
```

### 2. **–ü–∞—Ä—Å–µ—Ä data-parity.php** ‚ùå ‚Üí ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
```javascript
// –ë—ã–ª–æ (—Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç)
const counts = j.sqlite_counts ? `${j.sqlite_counts.regions ?? '‚Äî'}/${j.sqlite_counts.cities ?? '‚Äî'}/${j.sqlite_counts.pois ?? '‚Äî'}` : '‚Äî';
```

**–†–µ—à–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
```javascript
// –°—Ç–∞–ª–æ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞)
const countsObj = (j.counts && j.counts.sqlite) ? j.counts.sqlite : (j.sqlite_counts || {});
const orphansObj = j.orphans || j.sqlite_orphans || {};
const counts = countsObj ? `${countsObj.regions ?? '‚Äî'}/${countsObj.cities ?? '‚Äî'}/${countsObj.pois ?? '‚Äî'}` : '‚Äî';
```

### 3. **–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞ –≤ Performance** ‚ùå ‚Üí ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—á–∏—Ç–∞–ª–∞ —É—Å–ø–µ—Ö–æ–º `ok:true` –¥–∞–∂–µ –ø—Ä–∏ `auth:false`
```javascript
// –ë—ã–ª–æ (–Ω–µ—Ç–æ—á–Ω–æ)
success: out.json?.ok || false
```

**–†–µ—à–µ–Ω–∏–µ:** –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
```javascript
// –°—Ç–∞–ª–æ (—Ç–æ—á–Ω–æ)
const j = out.json || {};
const success = !!(j.ok && (j.auth === true || j.auth === undefined));
```

### 4. **–î—É–±–ª–∏–∫–∞—Ç –≤ –ø–æ–¥—Å–∫–∞–∑–∫–∞—Ö** ‚ùå ‚Üí ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ rate limiting
```html
<!-- –ë—ã–ª–æ (–¥—É–±–ª–∏–∫–∞—Ç) -->
<li>–õ–∏–º–∏—Ç—ã Airtable: <span class="kbd">429</span> + backoff. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <span class="kbd">Retry-After</span>.</li>
<li>Rate limiting: <span class="kbd">429</span> + backoff. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <span class="kbd">Retry-After</span>.</li>
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç
```html
<!-- –°—Ç–∞–ª–æ (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–∞) -->
<li>–õ–∏–º–∏—Ç—ã Airtable: <span class="kbd">429</span> + backoff. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <span class="kbd">Retry-After</span>.</li>
```

### 5. **–ú–∏–Ω–∏-–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞** ‚ùå ‚Üí ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—É—Å—Ç–æ–π—á–∏–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π
```javascript
// –ë—ã–ª–æ (–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ)
const maxTime = Math.max(...recent.map(entry => entry.responseTime), 100);
```

**–†–µ—à–µ–Ω–∏–µ:** –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```javascript
// –°—Ç–∞–ª–æ (—É—Å—Ç–æ–π—á–∏–≤–æ)
if (recent.length === 0) return;
const maxTime = Math.max(100, ...recent.map(e => e.responseTime || 0));
```

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 6. **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞** ‚ú®
**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞
```javascript
const startTime = performance.now();
const out = await fetchJson(url('/api/health-airtable.php'));
const endTime = performance.now();
const realLatency = Math.round(endTime - startTime);
const latencyText = serverLatency ? `${realLatency}ms (server: ${serverLatency}ms)` : `${realLatency}ms`;
```

### 7. **–°–≤–µ—Ç–æ—Ñ–æ—Ä –¥–ª—è Rotate Token** ‚ú®
**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–æ—Ç–∞—Ü–∏–∏
```javascript
// –ó–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∫–æ–≥–¥–∞ next –¥–æ—Å—Ç—É–ø–µ–Ω
if (j.auth?.next) {
  rotateBtn.className = 'px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200';
  rotateBtn.textContent = 'Rotate Token (Next Available)';
} else {
  // –°–µ—Ä–∞—è –∫–Ω–æ–ø–∫–∞ –∫–æ–≥–¥–∞ next –ø—É—Å—Ç
  rotateBtn.className = 'px-3 py-1 text-xs bg-gray-100 text-gray-500 rounded cursor-not-allowed';
  rotateBtn.textContent = 'Rotate Token (No Next)';
}
```

### 8. **–ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –ø—Ä–æ–º–æ—É—Ç–∞** ‚ú®
**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–æ—Å–ª–µ –ø—Ä–æ–º–æ—É—Ç–∞ —Ç–æ–∫–µ–Ω–∞
```javascript
// If just promoted, refresh other cards
if (j.reason === 'next_promoted') {
  await runWho();
  await runHealth();
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚ùå –ö–∞—Ä—Ç–æ—á–∫–∏ –º–æ–≥–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è (CSS @apply)
- ‚ùå Data Parity –ø–æ–∫–∞–∑—ã–≤–∞–ª "‚Äî" (–Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç)
- ‚ùå Performance –ø–æ–∫–∞–∑—ã–≤–∞–ª –ª–æ–∂–Ω—ã–µ —É—Å–ø–µ—Ö–∏ (auth:false = success)
- ‚ùå –î—É–±–ª–∏–∫–∞—Ç—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- ‚ùå –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ –º–æ–≥ –ø–∞–¥–∞—Ç—å —Å –æ—à–∏–±–∫–æ–π

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ API
- ‚úÖ –¢–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ß–∏—Å—Ç—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–∞—è —Ä–∞–±–æ—Ç–∞ –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## üéØ –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### **–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –¥–∞—à–±–æ—Ä–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å** - –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ** - –≤–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### **–î–ª—è —Å–∏—Å—Ç–µ–º—ã:**
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–±–æ—Ä–∫–∏
- ‚úÖ **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Ç–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. **CSS —Å—Ç–∏–ª–∏** - –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. **Data Parity** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
3. **Performance** - –∑–µ–ª–µ–Ω—ã–µ –±–∞—Ä—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å–ø–µ—Ö–µ
4. **–ü–æ–¥—Å–∫–∞–∑–∫–∏** - –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
5. **–ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π
6. **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
7. **Rotate Token** - –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
8. **–ü—Ä–æ–º–æ—É—Ç** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏

---

**üí° –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã. Health Dashboard —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ —Ç–æ—á–Ω–æ!**
