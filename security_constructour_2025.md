# Security & Compliance Guidelines for Constructour (2025)

Хотя технические требования упоминали HTTPS и Content Security Policy, отсутствовал подробный раздел о безопасности и защите данных【534680704413190†L673-L687】. Этот документ содержит рекомендации по обеспечению конфиденциальности и безопасности веб‑приложения Constructour.

## 1 Защита данных и конфиденциальность

- **Минимизация данных**: собирайте и храните только необходимую информацию (имя, контакты, предпочтения). Не храните паспортные данные или финансовую информацию клиентов в базе. 
- **Шифрование**: все данные передаются по HTTPS. При хранении чувствительных данных (например, комментариев, в которых могут быть адреса) используйте шифрование на сервере. 
- **GDPR и местное законодательство**: предоставляйте пользователям информацию о целях сбора данных и храните согласие. Позвольте пользователю запросить удаление его данных.

## 2 Аутентификация и авторизация

- Используйте **JWT** для аутентификации клиентов и гидов (см. `api_spec_constructour_2025.md`). Храните refresh‑token в HttpOnly‑cookie с флагами `Secure` и `SameSite=Strict`.
- Реализуйте **RBAC (Role‑Based Access Control)**: гиды могут редактировать только свои туры; администраторы имеют полный доступ; клиенты ограничены просмотром своей анкеты и маршрута.
- Ограничивайте попытки входа (rate limiting) и используйте Captcha, чтобы защититься от brute‑force атак.

## 3 Web Security

- **Content Security Policy (CSP)**: настройте заголовок `Content-Security-Policy` для ограничения источников скриптов, стилей и изображений. 
- **XSS и Injection**: экранируйте вводимые пользователем данные, используйте библиотеки для защиты от XSS (DOMPurify) и параметризованные запросы к базе для защиты от SQL‑инъекций (если используется серверная БД). 
- **CSRF**: защищайте state‑changing эндпоинты CSRF‑токенами. При использовании JWT + cookies требуйте заголовок `X-CSRF-Token`.
- **CORS**: явно указывайте доверенные домены в настройке CORS.

## 4 Безопасное программирование

- **Линтеры и анализаторы**: подключите ESLint‑plugin‑security, который проверяет распространённые уязвимости (e.g., небезопасное использование `eval` или `innerHTML`).
- **Зависимости**: регулярно обновляйте библиотеки и проверяйте их на наличие CVE (используйте Dependabot или `npm audit`).
- **Логирование**: логируйте ошибки на сервере без вывода конфиденциальных данных. Удаляйте чувствительные поля (email, phone) из логов и исключений.

## 5 Compliance & сертификаты

- При работе с платежами используйте PCI DSS‑совместимые платёжные шлюзы. Не храните номера карт на своём сервере.
- Для интеграции с внешними сервисами (Google Maps, Airtable) проверяйте лицензионные соглашения и ограничения по использованию данных.
- Включайте пользовательские соглашения и политику конфиденциальности на веб‑сайте; эти документы должны быть доступны на всех поддерживаемых языках.

## 6 Заключение

Безопасность должна рассматриваться на всех этапах разработки. Соблюдая вышеуказанные рекомендации, вы уменьшите риски утечки данных и других уязвимостей. Документ необходимо регулярно пересматривать, учитывая новые угрозы и требования законодательства. Помните, что безопасность — совместная ответственность: разработчики, администраторы и сторонние интеграции должны следовать единым правилам.