# –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –∏ Airtable

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

1. **–ù–ï —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏** –≤ Airtable
2. **–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è** –≤ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
3. **Airtable Record ID** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è —Å–≤—è–∑–∏
4. **Business ID** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π

## üìä –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π

### –†–µ–≥–∏–æ–Ω—ã (Regions)

| –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î | Airtable | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|----------|----------|
| `id` | `id` (Record ID) | Airtable Record ID - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `name_ru` | `Name (RU)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `name_en` | `Name (EN)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `business_id` | `ID` | Business ID (REG-XXX) |

**Airtable —Ç–∞–±–ª–∏—Ü–∞**: `tblbSajWkzI8X7M4U`

### –ì–æ—Ä–æ–¥–∞ (Cities)

| –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î | Airtable | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|----------|----------|
| `id` | `id` (Record ID) | Airtable Record ID - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `name_ru` | `Name (RU)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `name_en` | `Name (EN)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `business_id` | `A ID` | Business ID (CTY-XXX –∏–ª–∏ LOC-XXX) |
| `type` | `Type` | –¢–∏–ø (city/location) |
| `region_id` | `Region` | –°–≤—è–∑—å —Å —Ä–µ–≥–∏–æ–Ω–æ–º (Record ID) |

**Airtable —Ç–∞–±–ª–∏—Ü–∞**: `tblHaHc9NV0mA8bSa`

### POI (Points of Interest)

| –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î | Airtable | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|----------|----------|
| `id` | `id` (Record ID) | Airtable Record ID - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `name_ru` | `Name (RU)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `name_en` | `Name (EN)` | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `business_id` | `POI ID` | Business ID (POI-XXX) |
| `category` | `Category` | –ö–∞—Ç–µ–≥–æ—Ä–∏—è |
| `description` | `Description` | –û–ø–∏—Å–∞–Ω–∏–µ |
| `city_id` | `City ID` | –°–≤—è–∑—å —Å –≥–æ—Ä–æ–¥–æ–º (Record ID) |
| `region_id` | `Region` | –°–≤—è–∑—å —Å —Ä–µ–≥–∏–æ–Ω–æ–º (Record ID) |

**Airtable —Ç–∞–±–ª–∏—Ü–∞**: `tbl8X7M4U`

## üîÑ –õ–æ–≥–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 1. Airtable ‚Üí –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î

```php
// –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –∏–∑ Airtable:
$data = [
    'id' => $record['id'], // Airtable Record ID
    'name_ru' => $fields['Name (RU)'] ?? 'Unknown',
    'name_en' => $fields['Name (EN)'] ?? null,
    'business_id' => $fields['ID'] ?? null
];

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
$existing = $db->getRecord($data['id']);
if ($existing) {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
    if ($hasChanges($existing, $data)) {
        $db->updateRecord($data['id'], $data);
    }
} else {
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
    $db->saveRecord($data);
}
```

### 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î ‚Üí Airtable

```php
// –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î:
$fields = [
    'Name (RU)' => $record['name_ru']
];

if ($record['name_en']) {
    $fields['Name (EN)'] = $record['name_en'];
}

if ($record['business_id']) {
    $fields['ID'] = $record['business_id'];
}

// –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ Airtable
updateAirtableRecord($tableId, $record['id'], $fields);
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

1. **–†–µ–≥–∏–æ–Ω ‚Üí –ì–æ—Ä–æ–¥**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Airtable Record ID —Ä–µ–≥–∏–æ–Ω–∞
2. **–ì–æ—Ä–æ–¥ ‚Üí POI**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Airtable Record ID –≥–æ—Ä–æ–¥–∞  
3. **–†–µ–≥–∏–æ–Ω ‚Üí POI**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Airtable Record ID —Ä–µ–≥–∏–æ–Ω–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π

- –ï—Å–ª–∏ –ø–æ–ª–µ –≤ Airtable –ø—É—Å—Ç–æ–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ï—Å–ª–∏ –ø–æ–ª–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –ø—É—Å—Ç–æ–µ, –Ω–µ –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ Airtable
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `name_ru`, `id` (Record ID)

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö

- **Airtable —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã** –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- **–õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã** –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É Airtable

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Airtable

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ –ø–æ–ª—è –µ—Å—Ç—å –≤ Airtable
curl "https://yourdomain.com/api/check-airtable-structure.php"
```

### –¢–µ—Å—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
curl "https://yourdomain.com/api/sync-correct-test.php?action=sync"
```

### –†–µ–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–æ–∫–µ–Ω Airtable
export AIRTABLE_PAT="your_token_here"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
curl "https://yourdomain.com/api/sync-correct.php?action=sync"
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç—å Airtable —Ç–æ–∫–µ–Ω

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Airtable Developer Hub](https://airtable.com/create/tokens)
2. –°–æ–∑–¥–∞–π—Ç–µ Personal Access Token
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è: `data.records:read`, `data.records:write`
4. –í—ã–±–µ—Ä–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `apppwhjFN82N9zNqm`

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–æ–∫–µ–Ω

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
export AIRTABLE_PAT="your_token_here"

# –í–∞—Ä–∏–∞–Ω—Ç 2: –§–∞–π–ª .env
echo "AIRTABLE_PAT=your_token_here" >> .env
```

### 3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

–í `site-admin/databases.html` –∑–∞–º–µ–Ω–∏—Ç–µ:
```javascript
// –ë—ã–ª–æ:
const response = await fetch('/api/sync-correct-test.php?action=sync', {

// –°—Ç–∞–ª–æ:
const response = await fetch('/api/sync-correct.php?action=sync', {
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –û—à–∏–±–∫–∏: –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

–õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¥–∞—à–±–æ—Ä–¥–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: `/site-admin/sync-dashboard.html`
