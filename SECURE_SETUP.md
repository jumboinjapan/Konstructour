# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Airtable –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤
sudo mkdir -p /var/konstructour/secrets
sudo chown www-data:www-data /var/konstructour/secrets
sudo chmod 755 /var/konstructour/secrets

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª —Å–µ–∫—Ä–µ—Ç–æ–≤
php api/init-secrets.php
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Airtable —Ç–æ–∫–µ–Ω–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –∫–∞–∫ current
php api/set-token.php 'patYOUR_TOKEN_HERE' current

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∫ next (–¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏)
php api/set-token.php 'new-pat-token-here' next
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω —Ç–æ–∫–µ–Ω–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
export ADMIN_TOKEN="your-secure-admin-token-here"

# –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ .htaccess
echo "SetEnv ADMIN_TOKEN your-secure-admin-token-here" >> .htaccess
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab (–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç)
*/15 * * * * cd /path/to/konstructour && php api/cron-sync.php >> /var/log/konstructour-cron.log 2>&1
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `/var/konstructour/secrets/airtable.json`
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: 600 (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
- **–í–ª–∞–¥–µ–ª–µ—Ü**: www-data (–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞)
- **–§–æ—Ä–º–∞—Ç**: JSON —Å –¥–≤—É–º—è —Å–ª–æ—Ç–∞–º–∏ (current/next)

### –†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
1. **Current** - –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã
2. **Next** - —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–º–æ—É—à–Ω** - –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ current, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ next
4. **Zero-downtime** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–∞

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- `api/health-airtable.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- `api/test-proxy-secure.php` - –ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º failover
- `api/config-store-secure.php` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `api/sync-airtable-new.php` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ–∫—Ä–µ—Ç–æ–≤

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –ù–ï —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚úÖ Airtable PAT —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –ê–¥–º–∏–Ω —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –§–∞–π–ª—ã —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –∫–ª—é—á–∞–º–∏

### –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚úÖ Mapping –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Base ID, Table ID, View ID)
- ‚úÖ –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è PAT —Ñ–æ—Ä–º–∞—Ç–∞
- ‚úÖ Whoami –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîÑ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
curl https://www.konstructour.com/api/health-airtable.php
```

### –õ–æ–≥–∏
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ cron
tail -f /var/log/konstructour-cron.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ PHP
tail -f /var/log/php_errors.log | grep "KONSTRUCTOUR\|AIRTABLE"
```

### –°—Ç–∞—Ç—É—Å —Å–µ–∫—Ä–µ—Ç–æ–≤
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
cat /var/konstructour/secrets/airtable.json | jq .
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "No working Airtable token"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª —Å–µ–∫—Ä–µ—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Airtable

### –ü—Ä–æ–±–ª–µ–º–∞: "Forbidden" –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ADMIN_TOKEN –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-Admin-Token –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ cron
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/var/konstructour/secrets/`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ (755 –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, 600 –¥–ª—è —Ñ–∞–π–ª–∞)
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Airtable PAT —Ç–æ–∫–µ–Ω
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω ADMIN_TOKEN
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω cron –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω health check
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏

## üîÑ –†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤

### –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –≤ next —Å–ª–æ—Ç
2. –î–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–º–æ—É—à–Ω–∞ –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ
3. –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–º–æ—É—Ç–∏—Ç—å —á–µ—Ä–µ–∑ API

### –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –≤ current —Å–ª–æ—Ç
2. –û—á–∏—Å—Ç–∏—Ç—å next —Å–ª–æ—Ç
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å health check
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
4. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤
