# Performance & Metrics Guide for Constructour (2025)

В ходе анализа была отмечена недостаточность информации о конкретных показателях производительности. Старые документы упоминали lazy‑loading, но не приводили целевые значения【534680704413190†L688-L700】. Этот документ определяет метрики, инструменты измерения и рекомендации по оптимизации.

## 1 Ключевые Web Vitals

Для обеспечения высокой скорости и отзывчивости установите следующие показатели:

- **Largest Contentful Paint (LCP)** < **2 секунд** — время загрузки крупнейшего видимого элемента. Уменьшается через оптимизацию изображений и серверный рендеринг.
- **Cumulative Layout Shift (CLS)** < **0.1** — суммарное смещение элементов при загрузке. Уменьшается за счёт указания фиксированной высоты/ширины изображений и каркасов Skeleton.
- **First Input Delay (FID)** < **100 мс** — задержка между взаимодействием пользователя и реакцией браузера.
- **Time to Interactive (TTI)** — не обязательный, но желательный параметр; стремитесь к < 3 секунд.

## 2 Измерение и мониторинг

- Используйте **Lighthouse** (CLI или CI) для периодической проверки страниц. Включите тесты в pipeline (`npm run lighthouse`) и сохраняйте отчёты.
- Внедрите **Web Vitals** библиотеку на фронтенде, чтобы отправлять реальные показатели пользователей в аналитическую систему (например, Google Analytics или собственный сервер).
- Следите за размером бандла (Webpack, Next.js предоставляют анализатор). Удерживайте начальный бандл < 200 KB (gzip), используя динамический импорт и tree‑shaking.

## 3 Оптимизации

- **Изображения**: Используйте компонент `<Image>` (Next.js) с автоматическим ресайзом и форматом WebP. Загружайте изображения лениво (`loading="lazy"`).
- **Шрифты**: Храните шрифты локально; подключайте только необходимые стили и веса. Используйте `font-display: swap` и CSS‑переменные для размеров.
- **Код‑сплитинг**: Разбивайте приложение на модули, загружая только необходимый код на каждой странице. Используйте `next/dynamic` для heavy components.
- **Edge‑first**: Размещайте статику и API ближе к пользователю (CDN), чтобы снизить задержку.
- **Avoid Re-renders**: Используйте `React.memo`, `useCallback` и `useMemo` для предотвращения лишних перерисовок. Для длинных списков применяйте виртуализацию (react‑window).

## 4 Производительность при разработке

- Добавляйте производительные метрики в PR checklist. Если новый компонент значительно увеличивает бандл или тормозит рендер, оптимизируйте до слияния.
- При использовании анимаций (Framer Motion) обращайте внимание на производительность на мобильных устройствах; отключайте сложные эффекты при `prefers-reduced-motion`.
- Тестируйте страницы на ограниченном соединении (Slow 3G) и устройстве с низкой мощностью (виртуальный mobile device в DevTools).

## 5 Заключение

Установка конкретных целей и регулярное измерение производительности помогают поддерживать быстрое и отзывчивое приложение. Этот документ должен использоваться вместе с руководством по тестированию и развертыванию, чтобы автоматизировать проверку Web Vitals и предотвратить деградацию скорости. При обновлении технологий (React 19, Tailwind v4) пересматривайте пороги и инструменты.