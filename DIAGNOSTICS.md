# üî¨ –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã Konstructour

–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Airtable.

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. **kt_airtable_diag.sh** - –ë–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
./scripts/kt_airtable_diag.sh [host]
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- ‚úÖ Health check Airtable
- ‚úÖ WhoAmI —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite
- ‚úÖ Foreign Key –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- ‚úÖ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (10 –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 2. **test-failover.sh** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ failover
```bash
./scripts/test-failover.sh <host> <admin_token>
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- üîÑ –†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (next ‚Üí current)
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover –ø—Ä–∏ 401
- üîÑ Rate limiting –∏ retry –ª–æ–≥–∏–∫–∞
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
- üîí –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ PAT

### 3. **performance-test.sh** - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
./scripts/performance-test.sh [host] [requests]
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- ‚ö° –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–º–∏–Ω/–º–∞–∫—Å/—Å—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞)
- ‚ö° –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚ö° Rate limiting (429 –æ—à–∏–±–∫–∏)
- ‚ö° –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚ö° –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

### 4. **db-integrity-check.sh** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
./scripts/db-integrity-check.sh [db_path]
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- üóÑÔ∏è PRAGMA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SQLite
- üóÑÔ∏è Foreign Key —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
- üóÑÔ∏è –°–∏—Ä–æ—Ç—Å–∫–∏–µ –∑–∞–ø–∏—Å–∏
- üóÑÔ∏è –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
- üóÑÔ∏è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 5. **full-diagnostics.sh** - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
./scripts/full-diagnostics.sh [host] [admin_token]
```
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- üîç –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- üîç –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- üîç –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- üîç –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üîç –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- üîç –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
php -S localhost:8000 -t .

# –ë–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./scripts/kt_airtable_diag.sh http://localhost:8000

# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –∞–¥–º–∏–Ω —Ç–æ–∫–µ–Ω)
./scripts/full-diagnostics.sh http://localhost:8000 your-admin-token
```

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ë–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./scripts/kt_airtable_diag.sh https://www.konstructour.com

# –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
./scripts/performance-test.sh https://www.konstructour.com 50

# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./scripts/full-diagnostics.sh https://www.konstructour.com $ADMIN_TOKEN
```

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **Health Check**: `ok: true` - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **WhoAmI**: `auth: true` - —Ç–æ–∫–µ–Ω—ã –≤–∞–ª–∏–¥–Ω—ã
- **Sync**: `ok: true` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- **DB Integrity**: `0 orphans` - –Ω–µ—Ç —Å–∏—Ä–æ—Ç—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π
- **Performance**: `100% success rate` - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **Rate Limiting**: 429 –æ—à–∏–±–∫–∏ - –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
- **Empty Database**: 0 –∑–∞–ø–∏—Å–µ–π - –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- **Unstable Performance**: –±–æ–ª—å—à–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- **Health Check**: `ok: false` - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Auth Errors**: 401/403 - –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏
- **DB Orphans**: >0 - –Ω–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **Missing Files**: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: Health Check Failed
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω—ã
curl -sS https://www.konstructour.com/api/health-airtable.php | jq .

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f /var/log/php_errors.log | grep "HEALTH-AIRTABLE"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Database Orphans
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
./scripts/db-integrity-check.sh

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ä–æ—Ç—Å–∫–∏–µ –∑–∞–ø–∏—Å–∏
sqlite3 api/konstructour.db "DELETE FROM cities WHERE region_id NOT IN (SELECT id FROM regions);"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Performance Issues
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç
./scripts/performance-test.sh https://www.konstructour.com 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limiting
curl -sS -X POST https://www.konstructour.com/api/test-proxy-secure.php?provider=airtable \
  -H 'Content-Type: application/json' -d '{"whoami":true}' -w "%{http_code}"
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### Cron –∑–∞–¥–∞—á–∏
```bash
# –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
*/15 * * * * cd /path/to/konstructour && ./scripts/kt_airtable_diag.sh https://www.konstructour.com >> /var/log/konstructour-health.log 2>&1

# –ö–∞–∂–¥—ã–π —á–∞—Å - –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
0 * * * * cd /path/to/konstructour && ./scripts/full-diagnostics.sh https://www.konstructour.com $ADMIN_TOKEN >> /var/log/konstructour-full.log 2>&1
```

### –ê–ª–µ—Ä—Ç—ã
```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
#!/bin/bash
if ! ./scripts/kt_airtable_diag.sh https://www.konstructour.com >/dev/null 2>&1; then
  # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (email, Slack, etc.)
  echo "Konstructour health check failed" | mail -s "Alert" admin@example.com
fi
```

## üéØ Go/No-Go –∫—Ä–∏—Ç–µ—Ä–∏–∏

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
- [ ] –í—Å–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] Health check —Å—Ç–∞–±–∏–ª—å–Ω–æ `ok: true` ‚â• 24 —á–∞—Å–∞
- [ ] –ù–µ—Ç —Å–∏—Ä–æ—Ç—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö SLA
- [ ] –ù–µ—Ç —É—Ç–µ—á–µ–∫ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ª–æ–≥–∞—Ö
- [ ] Cron –∑–∞–¥–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

### ‚ùå –ù–µ –≥–æ—Ç–æ–≤–æ
- [ ] –õ—é–±—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- [ ] –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- [ ] –ü—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
- [ ] –ù–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- [ ] –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [SECURE_SETUP.md](SECURE_SETUP.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [API Documentation](api/) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- [Logs](logs/) - –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
- [Monitoring](monitoring/) - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

---

**üí° –°–æ–≤–µ—Ç**: –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.
